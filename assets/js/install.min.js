jQuery(document).ready(function(e){var t=e(".rp4wp-step").attr("rel");function s(t){this.step=t,this.total_posts=0,this.ppr=null,this.action=null,this.percentage_object=null,this.nonce=null,this.do_request=function(){var r=this;e.post(ajaxurl,{action:this.action,nonce:e("#rp4wp-ajax-nonce").val(),ppr:this.ppr,rel_amount:e("#rp4wp_related_posts_amount").val()},function(t){var s=new RegExp("^[0-9]+$");t=t.trim(),s.test(t)?(s=parseInt(t),r.do_progressbar(s),0<s?r.do_request():r.done()):alert("Woops! Something went wrong while linking.\n\nResponse:\n\n"+t)})},this.done=function(){e("#progressbar").progressbar({value:100}),window.location=e("#rp4wp_admin_url").val()+"?page=rp4wp_install&rp4wp_nonce="+this.nonce+"&step="+(this.step+1)},this.do_progressbar=function(t){var s=this.total_posts-t,t=(s<0&&(s=0),jQuery("#progress-done").html(s),jQuery("#progress-todo").html(t),Math.round(s/this.total_posts*100));0<t&&(this.percentage_object.html(t+"%"),e("#progressbar").progressbar({value:t}))},this.init=function(){switch(e("#progressbar").progressbar({value:!1}),this.percentage_object=jQuery("<span>"),e("#progressbar").find("div:first").append(this.percentage_object),this.do_progressbar(e("#rp4wp_posts_todo").val()),this.total_posts=e("#rp4wp_total_posts").val(),this.nonce=e("#rp4wp_nonce").val(),this.step){case 1:this.ppr=25,this.action="rp4wp_install_save_words";break;case 2:this.ppr=5,this.action="rp4wp_install_link_posts"}jQuery("#progress-container").show(),this.do_request()},this.init()}1==t?s(1):2==t&&e("#rp4wp-link-now").click(function(){s(2)})});